"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3666],{65445:function(e,n,t){t.d(n,{jF:function(){return h},x:function(){return v},QB:function(){return C},Oj:function(){return b}});var o,r,i,a,l=t(31874),c=t(59233),u=t(17422),s=t(82030),d=t(92799),f=t(70080),p=t(72818);"https://admin-cms.cookunity.com/api".replace("api","graphql");let m=(0,s.q)(e=>{var n;let{networkError:t,graphQLErrors:o,operation:r}=e,i=r.getContext(),a=i.headers,l=null===(n=i.response)||void 0===n?void 0:n.url;if(t){if("bodyText"in t)try{JSON.parse(t.bodyText)}catch(e){t.message=t.bodyText}p.b.error("[Apollo network error]:",{error:t.name,message:t.message,cause:t.cause,stack:t.stack,operation:r.operationName,variables:r.variables,headers:a,responseUrl:l})}o&&o.map(e=>{let{message:n,locations:t,path:o}=e;p.b.error("[Graphql network error]:",{message:n,locations:t,path:o,operation:r.operationName,variables:r.variables,headers:a,responseUrl:l})})}),g=e=>{let{uri:n,token:t,headers:o,options:r={watchQuery:{fetchPolicy:"cache-first",errorPolicy:"ignore"},query:{fetchPolicy:"cache-first",errorPolicy:"all"}}}=e,i=(0,d.L)({uri:n,credentials:"include"}),a=new u.i0((e,n)=>(e.setContext(()=>({headers:{...o,authorization:t?"Bearer ".concat(t):null}})),n(e))),s=m.concat(a.concat(i));return new c.fe({link:s,cache:new l.h4,defaultOptions:r})};var y=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g({uri:"https://subs-back.cookunity.com/graphql/public"}).query({query:(0,f.ZP)(e),variables:n})};(o=i||(i={})).LATEST_ARTICLES="latest_articles",o.FEATURED_MEALS="featured_meals",o.CLIMATE_FRIENDLY_MEALS="climate_friendly",(r=a||(a={}))[r.ONE_HOUR=36e5]="ONE_HOUR",r[r.TWO_HOURS=72e5]="TWO_HOURS",t(95658);let h=(e,n)=>y("\n    query getCouponData($coupon: String!, $countryCode: String!) {\n      coupon(coupon: $coupon, countryCode: $countryCode) {\n        source\n        code\n        expiry\n        promotion {\n          id\n          title\n          promotionType\n          discount {\n            id\n            rate\n            duration\n            type\n            typeOfUse\n          }\n          credit {\n            id\n            amount\n          }\n        }\n        restrictions {\n          notAvailablePlans\n          notAvailableDays {\n            store\n            days\n          }\n        }\n        isEligible {\n          isEligible\n          message\n          type\n        }\n      }    \n    }\n  ",{coupon:e,countryCode:n||"US"}),v=(e,n)=>y("\n    query featuredMeals($source: Source, $attrs: Attrs) {\n      featuredMeals(source: $source, attrs: $attrs) {\n        entity_id\n        name\n        short_description\n        calories\n        image\n        image_key\n        image_path\n        price\n        sku\n        category_id\n        chef_id\n        chef_firstname\n        chef_lastname\n        is_celebrity_chef\n        new_meal\n        new_chef\n        logopic\n        bannerpic\n        stock\n        inStock\n        meat_type\n        meat_category\n        stars\n        reviews\n        premium_fee\n      }\n    }\n  ",{source:n||"STATIC",attrs:e||null}),b=e=>y("\n      query SampleMenuByStore($storeId: Int!) {\n        sampleMenuByStore(storeId: $storeId) {\n          date,\n          storeId,\n          meals {\n            entity_id\n            premium_fee\n            name\n            short_description\n            cuisines\n            calories\n            image\n            image_path\n            price\n            sku\n            category_id\n            chef_id\n            chef_firstname\n            chef_lastname\n            feature {\n              name\n              description\n              icon\n              color\n              background\n            }\n            bannerpic\n            stock\n            inStock\n            meat_type\n            stars\n            reviews\n            ingredients_data {\n              name\n            }\n            weight\n            warning\n            is_celebrity_chef\n            sidedish {\n                id\n                __typename\n            }\n            specifications_detail {\n                label\n                image\n                __typename\n            },\n            __typename\n          }\n        }\n      }\n      ",{storeId:e}).then(e=>e&&e.data&&e.data.sampleMenuByStore),C=(e,n,t)=>y("\n  query mealPlans($zipCode: String, $couponCode: String, $onlyEconomicPlans: Boolean) {\n    plans: availablePlans(zipcode: $zipCode, couponCode: $couponCode, onlyEconomicPlans: $onlyEconomicPlans) {\n      id\n      title\n      price\n      mealsPerDelivery\n      deliveries\n      deliveryFee\n      segmentId\n    }\n  }\n",{zipCode:e,couponCode:n,onlyEconomicPlans:t}).then(e=>e&&e.data&&e.data.plans)},92030:function(e,n,t){t.d(n,{C:function(){return i}});var o=t(57437),r=t(7409);let i=e=>{(0,r.Am)(()=>(0,o.jsx)("span",{className:"toast-send-mail",children:e}),{position:"top-center",hideProgressBar:!0,closeButton:!0})};n.default=()=>(0,o.jsx)(r.Ix,{})},76114:function(e,n,t){t.d(n,{GeolocationProvider:function(){return u},Z:function(){return s}});var o=t(57437),r=t(2265),i=t(72818),a=(e,n)=>{try{window.localStorage.setItem(e,JSON.stringify(n))}catch(n){i.b.error("Failed to store ".concat(e," in localStorage"),n)}};let l={zipCode:null,country:null,countryRegion:null,countryRegionName:null,city:null},c=(0,r.createContext)(l);function u(e){let{children:n,geolocation:t}=e,[u,s]=(0,r.useState)(t||l);return(0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/geolocation"),n=await e.json();s(n),a("geolocation",n)}catch(e){i.b.error("Error fetching geolocation:",{},e),s(l),a("geolocation",l)}};t?(s(t),a("geolocation",t)):e()},[t]),(0,o.jsx)(c.Provider,{value:u,children:n})}let s=()=>{if(!c)throw Error("GeolocationContext is not available");return(0,r.useContext)(c)}},66890:function(e,n,t){t.d(n,{Bn:function(){return r},Fp:function(){return d},H:function(){return c},KZ:function(){return a},LG:function(){return i},VB:function(){return s},Ww:function(){return l},zj:function(){return u}});var o=t(21099);let r="GET50OFF",i={promoCode:r,promoText:"SUBSCRIBE NOW AND SAVE 50% ON YOUR FIRST ORDER"},a="promo",l="@CU/discountCode",c="@CU/discountText",u=7*o.s2,s="landings_fallback_coupon_override",d="Growth - Home - Fallback coupon override"},6175:function(e,n,t){t.d(n,{E:function(){return a},g:function(){return c}});var o=t(11614),r=t(66890),i=t(96015);let a=e=>{if(e){let n=(0,i.yT)(window.location.hostname),t={maxAge:r.zj,domain:n};(0,o.setCookie)(r.Ww,e.promoCode,t),(0,o.setCookie)(r.H,e.promoText,t)}else l()},l=()=>{(0,o.deleteCookie)(r.Ww),(0,o.deleteCookie)(r.H)},c=()=>{let e=(0,o.getCookie)(r.Ww),n=(0,o.getCookie)(r.H);return"string"!=typeof e||"string"!=typeof n?(l(),null):{promoCode:e,promoText:n}}},30515:function(e,n,t){t.d(n,{Es:function(){return m},Gx:function(){return g},PromotionProvider:function(){return p}});var o=t(57437),r=t(2265),i=t(99376),a=t(66890),l=t(6175),c=t(42283),u=t(17206),s=t(72818),d=t(92242);let f=(0,r.createContext)({promoCode:"",promoText:"",promoData:{discount:{type:"",rate:0}},loading:!0,setInitialPromotion:()=>{},ctaText:"",expiresAt:null});function p(e){let{children:n}=e,{market:t}=(0,u.A)(),{toggles:p}=(0,d.u$)(),[m,g]=(0,r.useState)(null),[y,h]=(0,r.useState)(!0),[v,b]=(0,r.useState)(null),C=(0,i.useSearchParams)(),w=(0,r.useRef)(!1),_=async()=>{h(!0);try{let e=k();await O(e)}catch(e){s.b.error("Failed to process promotions",e),g(a.LG)}finally{h(!1),s.b.info("PromotionProvider: promotion loading complete")}},x=()=>{let e=null==C?void 0:C.get("utm_source");return"demo"===e||"B2B"===e?{promoCode:"DUMMY",promoText:""}:null},E=async()=>{let e=null==C?void 0:C.get(a.KZ);return e?await (0,c.DU)(e,t):null},T=async()=>{if(!v)return null;try{var e;let n=await (0,c.DU)(v.promoCode,t);if(!n)return null;return{promoCode:n.promoCode,promoText:null!==(e=v.promoText)&&void 0!==e?e:n.promoText,promoData:n.promoData}}catch(e){return s.b.error("Failed to fetch initial promotion",e),null}},S=()=>{try{return(0,l.g)()}catch(e){return s.b.error("Failed to get promotion from cookies",e),null}},P=async()=>{try{return(0,c.x2)({toggles:p})}catch(e){return s.b.error("Failed to get fallback coupon promotion",e),null}},k=()=>[x,E,T,S,P,()=>a.LG],O=async e=>{for(let n of e)try{let t=await n();if(t){U(t,n!==e[3]);break}}catch(e){s.b.error("Failed to process promotion source",e);continue}},U=async(e,n)=>{g({...e,ctaText:(0,c.o1)(e.promoCode),lastUpdated:Date.now()}),n&&(0,l.E)(e),await new Promise(e=>setTimeout(e,0))};(0,r.useEffect)(()=>{w.current||(w.current=!0),_()},[C,v]);let A=(0,r.useMemo)(()=>{var e,n,t,o,r,i;return{promoCode:null!==(e=null==m?void 0:m.promoCode)&&void 0!==e?e:"",promoText:null!==(n=null==m?void 0:m.promoText)&&void 0!==n?n:"",promoData:null!==(t=null==m?void 0:m.promoData)&&void 0!==t?t:{discount:{type:"",rate:0}},expiresAt:null!==(o=null==m?void 0:m.expiresAt)&&void 0!==o?o:null,loading:y,setInitialPromotion:e=>{b(e)},ctaText:null!==(r=null==m?void 0:m.ctaText)&&void 0!==r?r:"",lastUpdated:null!==(i=null==m?void 0:m.lastUpdated)&&void 0!==i?i:Date.now()}},[m,y]);return(0,o.jsx)(f.Provider,{value:A,children:n})}function m(){return(0,r.useContext)(f)||{promoCode:"",promoText:"",promoData:{discount:{type:"",rate:0}},loading:!0,setInitialPromotion:()=>{},ctaText:"",expiresAt:null}}function g(e,n){let{setInitialPromotion:t}=m(),o=(0,r.useRef)(!1);(0,r.useEffect)(()=>{e&&!o.current&&(o.current=!0,t({promoCode:e,promoText:null!=n?n:""}))},[e,n,t])}},42283:function(e,n,t){t.d(n,{DU:function(){return u},o1:function(){return s},x2:function(){return c}});var o=t(66890);t(6175);var r=t(65445),i=t(71487),a=t(72818),l=t(15390);let c=e=>{let{toggles:n}=e,t=n.fallbackCoupon;if(t&&"boolean"!=typeof t){var r,i,c;if(l.Z.registerTrack("Experiment Viewed",{experiment_id:o.VB,experiment_name:o.Fp,variation_name:t.name}),null===(r=t.payload)||void 0===r?void 0:r.value){let e;try{if((e="string"==typeof t.payload.value?JSON.parse(t.payload.value):t.payload.value)&&e.promoCode)return{promoCode:e.promoCode,promoText:null!==(i=e.promoText)&&void 0!==i?i:"",promoModalData:null!==(c=e.promoModalData)&&void 0!==c?c:null}}catch(e){a.b.error("Failed to parse fallback coupon data",e)}}}return null},u=async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.I.US;try{let t=await (0,r.jF)(e,n);return{promoCode:t.data.coupon.code,promoText:t.data.coupon.promotion.title,promoData:t.data.coupon.promotion}}catch(e){return a.b.error("[fetchPromotionById] Invalid promo data"),null}},s=e=>{var n;return null!==(n=({GET50OFF4J:"Join for 50% off",GET30OFF4J:"Join for 30% off",SAVE6020:"Join for 60% off",CRM60:"Join for 60% off",GOOGLE50103:"Join for 50% off",CRM50:"Join for 50% off",META50PROMO:"Join for 50% off"})[e])&&void 0!==n?n:"Enroll Now"}},17206:function(e,n,t){t.d(n,{A:function(){return i}});var o=t(99376),r=t(71487);let i=()=>{let e=(0,o.usePathname)().includes("/en-ca"),n=e?r.I.CA:r.I.US;return{isCA:e,isUs:!e,market:n}}},71487:function(e,n,t){var o,r;t.d(n,{I:function(){return o}}),(r=o||(o={})).US="US",r.CA="CA"},21099:function(e,n,t){t.d(n,{D2:function(){return a},P5:function(){return r},P_:function(){return i},s2:function(){return o}});let o=86400,r=31536e3,i=768,a="@CU/TrackUuid"},96015:function(e,n,t){t.d(n,{Fw:function(){return r},HI:function(){return a},Qu:function(){return o},ZN:function(){return i},d8:function(){return c},ej:function(){return u},yT:function(){return l}});let o="PROMO_POPUP_COOKIE",r=7,i="PROMO_BANNER_COOKIE",a=7;function l(e){let n=e.replace(/www.|eat./g,"");return"localhost"===n?"":".".concat(n)}function c(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,o=function(e){let n=new Date;return n.setTime(n.getTime()+864e5*e),n}(t),r=";expires=".concat(o.toUTCString()),i=l(window.location.hostname);document.cookie="".concat(e,"=").concat(n).concat(";domain=".concat(i)).concat(r,";path=/")}function u(e){{let n=e+"=",t=document.cookie.split(";");for(let e=0;e<t.length;e++){let o=t[e];for(;" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return null}}},72818:function(e,n,t){t.d(n,{b:function(){return c}});var o=t(2945),r=t(97435),i=t.n(r),a=t(25566);class l{setupGlobalErrorHandlers(){this.isClient?(window.onerror=(e,n,t,o,r)=>(this.error("Unhandled exception",{message:e,source:n,lineno:t,colno:o},r),!1),window.addEventListener("unhandledrejection",e=>{this.error("Unhandled promise rejection",{reason:e.reason},e.reason instanceof Error?e.reason:Error(String(e.reason)))})):(a.on("uncaughtException",e=>{this.error("Uncaught exception",{},e)}),a.on("unhandledRejection",e=>{this.error("Unhandled rejection",{reason:e instanceof Error?e.message:JSON.stringify(e)},e instanceof Error?e:Error(JSON.stringify(e)))}))}log(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;this.debugMode?console[e](n,t):this.isClient?o.fy.logger[e](n,t,r):this.pinoLogger[e]({err:r||t},n)}error(e,n,t){this.log("error",e,n,t)}warn(e,n){this.log("warn",e,n)}info(e,n){this.log("info",e,n)}constructor(e={}){this.isClient=!0,this.debugMode=e.debugMode||!1,this.pinoLogger=i()({level:this.debugMode?"debug":"info",formatters:{level:e=>({level:e})}}),!1!==e.captureGlobalErrors&&this.setupGlobalErrorHandlers()}}let c=new l({captureGlobalErrors:!0})},15390:function(e,n,t){t.d(n,{Z:function(){return h}});var o=t(65981),r=t(49360),i=t(21099),a=t(96015),l=t(95658),c=t(72818),u=t(6175),s=e=>{try{let n=window.localStorage.getItem(e);if(n)return JSON.parse(n);return null}catch(n){return c.b.error("Failed to retrieve ".concat(e," from localStorage"),n),null}};let d=o.b.load({writeKey:"Q4dutd3GFRY4rQAgPTj2GfwoftGSDaF8"}),f=(()=>{try{let e=(0,a.ej)(i.D2);if(e)return d.setAnonymousId(e),e;let n=(0,r.Z)();return(0,a.d8)(i.D2,n,i.P5),n}catch(e){return c.b.error("Error [getTrackUuid]",{},e),""}})();f&&d.setAnonymousId(f);let p={"/":"Landing Page - Homepage"},m=()=>{try{var e;let n=window.location.pathname,t=s("geolocation"),o=(0,u.g)();return{title:window.document.title,url:window.location.href,page_name:null!==(e=p[n])&&void 0!==e?e:n,country:n.includes("/en-ca")?"CA":"US",device:(0,l._v)(),deviceOS:(0,l.Fe)(),coupon_code:(null==o?void 0:o.promoCode)||"",geolocation:null!=t?t:null}}catch(e){return c.b.error("Error [getGenericProps]",{},e),{}}},g=async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let t={...m(),...n};await d.track(e,t)}catch(t){c.b.error("Error [registerTrack]",{eventName:e,properties:n},t)}},y=async(e,n)=>{try{let t={...m(),...n};await d.page(e,t)}catch(t){c.b.error("Error [registerPage]",{eventName:e,properties:n},t)}};var h={getGenericProps:m,registerTrack:g,registerPage:y,registerIdentify:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{await d.identify(e)}catch(n){c.b.error("Error [registerIdentify]",{traits:e},n)}},getTraits:async()=>{try{return(await d.user()).traits()}catch(e){return c.b.error("Error [getTraits]",{},e),null}}}},92242:function(e,n,t){t.d(n,{Oq:function(){return i},UnleashProvider:function(){return a},u$:function(){return l}});var o=t(57437),r=t(2265);let i=(0,r.createContext)({toggles:{}});function a(e){let{children:n,toggles:t}=e,a=(0,r.useMemo)(()=>({toggles:t}),[t]);return(0,o.jsx)(i.Provider,{value:a,children:n})}let l=()=>{if(!i)throw Error("UnleashContext is not available");return(0,r.useContext)(i)}},95658:function(e,n,t){t.d(n,{Fe:function(){return r},_v:function(){return i},u0:function(){return a}});var o=t(62061);function r(){let{os:{name:e}}=(0,o.UAParser)(navigator.userAgent);return e}let i=()=>!function(){let{device:{type:e}}=(0,o.UAParser)(navigator.userAgent);return"mobile"===e}()?"Web Desktop":"Mobile Web",a=e=>e.replace(/(https:\/\/)|(\/{2,})/g,(e,n)=>n||"/")}}]);
//# sourceMappingURL=3666-e6172b07b393abe6.js.map